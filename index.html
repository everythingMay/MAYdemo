
<!-- saved from url=(0042)http://localhost:63342/untitled/ceshi.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8">
<title>贪吃蛇2.3</title>
</head><body>
<style>
    .stop{
        margin-left: 850px;
        width: 150px;
        height: 80px;
        font-size: 25pt;
    }
    .snake{
        float: left;

    }
    .begin{
        margin-left: 850px;
        margin-top: 20px;
        width: 150px;
        height: 80px;
        font-size: 25pt;
    }
</style>

<script>
    var map;//地图
    var food;//食物
    var snake;//蛇
    var sum=0;
    var timer;
    function style(node,width,height,position,co,X,Y){
        node.style.width= width+'px';
        node.style.height= height+'px';
        node.style.position= position;
        node.style.background=co;
        node.style.left= X *20;
        node.style.top= Y *20;
        document.getElementsByTagName('div')[0].appendChild(node);

    }
    function MAP(){
        var $map=document.createElement("div");
        style($map,800,600,'absolute','#eeeeee');
        //document.getElementsByTagName('body')[0].appendChild($map);

    }
    var $food=document.createElement("div");
    var b = '#' + (Math.random() * 0xffffff << 0).toString(16);
    var x=Math.floor(Math.random()*800/20);
    var y=Math.floor(Math.random()*600/20);

    function FOOD(){

        style($food,20,20,'absolute',b,x,y);
        //document.getElementsByTagName('body')[0].appendChild($food );
    }
    var $snake=document.createElement("div");
    var snakex=Math.floor(Math.random()*800/20);
    var snakey=Math.floor(Math.random()*600/20);
    var Body=[];
    Body [0]=[snakex,snakey,'#FFFFCC',null];

    function Snake() {
        this.show = function () {
            //style($snake, 20, 20, 'absolute', '#FFFFCC', snakex, snakey);
            for(var i=0;i<Body.length;i++){
                if(Body[i][3]==null){
                    Body[i][3]=document.createElement("div");
                    Body[i][3].style.width='20px';
                    Body[i][3].style.height='20px';
                    Body[i][3].style.position='absolute';
                    Body[i][3].style.background=Body[i][2];
                    document.getElementsByTagName('div')[0].appendChild(Body[i][3]);


                }
                Body[i][3].style.left=Body[i][0]*20;
                Body[i][3].style.top=Body[i][1]*20;
            }

        }
        direction = '';

        //添加键盘事件
        document.onkeydown = function (e) {
            var e = event || window.event || arguments.callee.caller.arguments[0];
            switch (e && e.keyCode) {
                case 37:
                {
                    if (direction == 'right') {
                        break;
                    }
                    direction = 'left';
                    break;
                }
                case 38:
                {
                    if (direction == 'down') {
                        break;
                    }
                    direction = 'up';
                    break;

                }
                case 39:
                {
                    if (direction == 'left') {
                        break;
                    }
                    direction = 'right';
                    break;
                }
                case 40:
                {
                    if (direction == 'up') {
                        break;
                    }
                    direction = 'down';
                    break;
                }
            }
        }

        function move() {

            for (var i = Body.length - 1; i > 0; i--) {
                Body[i][0] = Body[i - 1][0];
                Body[i][1] = Body[i - 1][1];
            }

            switch (direction) {
                case 'left':
                {
                    Body[0][0] = Body[0][0] - 1;
                    break;
                }
                case 'up':
                {
                    Body[0][1] = Body[0][1] - 1;
                    break;
                }
                case  'right':
                {
                    Body[0][0] = Body[0][0] + 1;
                    break;
                }
                case 'down':
                {
                    Body[0][1] = Body[0][1] + 1;
                    break;
                }
            }
            //checkNextStep();
            //style($snake, 20, 20, 'absolute', '#FFFFCC', Body[0][0], Body[0][1]);

            //timer = setInterval(move, 500);

            if (Body[0][0] < 0 || Body[0][0] > 40 || Body[0][1] < 0 || Body[0][1] > 30) {
                alert('撞墙死亡!' + ' ' + '分数=' + sum);
                clearInterval(timer);
                return;
            }

            if (Body[0][0] == x && Body[0][1] == y) {
                sum++;
                //alert(sum);
                var c = '#' + (Math.random() * 0xffffff << 0).toString(16);
                var xx = Math.floor(Math.random() * 800 / 20);
                var yy = Math.floor(Math.random() * 600 / 20);
                style($food, 20, 20, 'absolute', c, xx, yy);
                b = c;
                x = xx;
                y = yy;
                Body.push([xx, yy, '#FFFFFF', null])

            }
            for(var i=0;i<Body.length;i++){
                if(Body[0][0]==x && Body[0][1]==y){
                    alert('触碰蛇身!' + ' ' + '分数=' + sum);
                    clearInterval(timer);
                    return;
                }
            }
            snake.show();

        }
        timer = setInterval(move, 150);



    }




    window.onload=function()
    {
        map = new MAP();

        food= new FOOD();

        snake=new Snake();
        snake.show();


    }


</script>
<input class="stop" type="button" value="暂停" onclick="clearInterval(timer)">
<div class="snake"><div style="width: 800px; height: 600px; position: absolute; background: rgb(238, 238, 238);"></div><div style="width: 20px; height: 20px; position: absolute; left: 600px; top: 220px; background: rgb(96, 245, 167);"></div><div style="width: 20px; height: 20px; position: absolute; left: 480px; top: 100px; background: rgb(255, 255, 204);"></div></div>
<input class="begin" type="button" value="重新开始" onclick="Snake()">



</body></html>